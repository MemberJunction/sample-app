-----------------------------------------------------------------
-- SQL Code Generation
-- Entity: Entity Relationships
-- Item: spCreateEntityRelationship
-- Generated: 12/8/2023, 3:54:02 PM
--
-- This was generated by the Entity Generator.
-- This file should NOT be edited by hand.
-----------------------------------------------------------------

------------------------------------------------------------
----- CREATE PROCEDURE FOR EntityRelationship
------------------------------------------------------------
IF OBJECT_ID('dbo.spCreateEntityRelationship', 'P') IS NOT NULL
    DROP PROCEDURE [dbo].[spCreateEntityRelationship]
GO

CREATE PROCEDURE [dbo].[spCreateEntityRelationship]
    @EntityID int,
    @RelatedEntityID int,
    @BundleInAPI bit,
    @IncludeInParentAllQuery bit,
    @Type nchar(20),
    @EntityKeyField nvarchar(50),
    @RelatedEntityJoinField nvarchar(50),
    @JoinView nvarchar(50),
    @JoinEntityJoinField nvarchar(50),
    @JoinEntityInverseJoinField nvarchar(50),
    @DisplayInForm bit,
    @DisplayName nvarchar(50)
AS
BEGIN
    SET NOCOUNT ON;
    INSERT INTO 
    [admin].[EntityRelationship]
        (
            [EntityID],
            [RelatedEntityID],
            [BundleInAPI],
            [IncludeInParentAllQuery],
            [Type],
            [EntityKeyField],
            [RelatedEntityJoinField],
            [JoinView],
            [JoinEntityJoinField],
            [JoinEntityInverseJoinField],
            [DisplayInForm],
            [DisplayName]
        )
    VALUES
        (
            @EntityID,
            @RelatedEntityID,
            @BundleInAPI,
            @IncludeInParentAllQuery,
            @Type,
            @EntityKeyField,
            @RelatedEntityJoinField,
            @JoinView,
            @JoinEntityJoinField,
            @JoinEntityInverseJoinField,
            @DisplayInForm,
            @DisplayName
        )

    -- return the new record from the base view, which might have some calculated fields
    SELECT * FROM vwEntityRelationships WHERE ID = SCOPE_IDENTITY()
END
GO
GRANT EXECUTE ON [spCreateEntityRelationship] TO [cdp_Developer], [cdp_Integration]
